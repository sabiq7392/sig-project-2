<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <style>
    * {
      margin: 0;
    }
    #map {
      height: 100vh;
    }
  </style>
  <!-- Make sure you put this AFTER Leaflet's CSS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>

<body>
  <div id="map"></div>
  <script>
    (async() => {
      // const petaDataRaw = await fetch("https://sv-925-60-sig-microservice.*******/provinsi");
      const petaDataRaw = await fetch("https://sv-925-60-sig-microservice.govtechindonesia.id/provinsi");
      const petaData = await petaDataRaw.json();
      const map = L.map('map').setView([-1.9641610627021628, 112.5370412852939], 5);
      L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(map);

      const loi = petaData;
      const buildBindPopup = (layer) => `
        <div>
          <p style="font-weight: bold;">${layer.feature.properties.nama}</p>
          <p>${layer.feature.properties.deskripsi}</p>
          <p>
            <span><b>Nama Gubernur: </b> ${layer.feature.properties.nama_gubernur}<span>
            <br/>
            <span><b>Wisata Favorit: </b> ${layer.feature.properties.wisata_favorit}</span>
          </p>
        </div>
      `; 

      const geojson = L.geoJSON(loi, {
        onEachFeature(feature, layer) {
          layer.bindPopup(buildBindPopup(layer));
        }
      }).addTo(map);

      L.geoJSON(geojson).bindPopup((layer) => buildBindPopup(buildBindPopup(layer))).addTo(map);
    })()

  </script>
</body>

</html>